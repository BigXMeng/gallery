name: GitHub Page

on:
    push:
        branches:
            - main # main ���´���

jobs:
    deploy:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v3
              with:
                  submodules: true # clone submodules
                  fetch-depth: 0 # ��¡������ʷ��Ϣ

            - name: Setup Hugo
              uses: peaceiris/actions-hugo@v2
              with:
                  hugo-version: "0.120.1" # Hugo �汾
                  extended: true # hugo����� Stack���� ��������

            - name: Cache resources # ���� resource �ļ��ӿ������ٶ�
              uses: actions/cache@v3
              with:
                  path: resources
                  # �����Ƭ�ļ��仯
                  key: ${{ runner.os }}-hugocache-${{ hashFiles('content/**/*') }}
                  restore-keys: ${{ runner.os }}-hugocache-

            - name: Build # ������ҳ ɾ������ resource �ļ� ��������
              run: hugo --minify --gc

            - name: Deploy # ���� GitHub Page
              uses: peaceiris/actions-gh-pages@v3
              with:
                  # �����ͬһ���ֿ���ʹ����ʹ�� github_token ��ע�� deploy_key
                  # github_token: ${{ secrets.GITHUB_TOKEN }}
                  deploy_key: ${{ secrets.ACTIONS_DEPLOY_KEY }}

                  # �����ͬһ���ֿ���ע��
                  external_repository: Jinxuan-578/blog # ��� GitHub page �ֿ� example/example.github.io

                  publish_dir: ./public
                  user_name: "github-actions[bot]"
                  user_email: "github-actions[bot]@users.noreply.github.com"
                  full_commit_message: Deploy from ${{ github.repository }}@${{ github.sha }} ?

